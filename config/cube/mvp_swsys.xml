<?xml version="1.0" encoding="UTF-8" ?>

<swsys>

    <bus name="control" max_topics="256" eq_channel="1">
<!--        <event_queue size="20" buffer_size="2000"/>-->
    </bus>

    <bus name="gcu" max_topics="256">
        <dir name="hk" eq_channel="16"/>
        <dir name="nav" eq_channel="16"/>
        <dir name="cont" eq_channel="16"/>

        <event_queue size="16" buffer_size="4000"/>
    </bus>


    <service type="sdtl" name="gcu_link">
        <param alias="baudrate">57600</param>
        <param alias="ser_path">/dev/ttyS1</param>

        <channel name="downlink" id="1" type="rel" />
        <channel name="downlink_sk" id="2" type="unrel" />
    </service>

    <service type="eqrb_sdtl" name="debug_sdtl">
        <param alias="service">gcu_link</param>
        <param alias="channel_1">downlink</param>
        <param alias="channel_2">downlink_sk</param>
        <param alias="bus">gcu</param>
    </service>

    <task type="flow" name="control_flow" config="mvp_flow_control.xml" priority="6" clk_method="freerun">
        <connect>
            <out alias="wx">control/wx</out>
            <out alias="wy">control/wy</out>
            <out alias="wz">control/wz</out>
            <out alias="ax">control/ax</out>
            <out alias="ay">control/ay</out>
            <out alias="az">control/az</out>

            <out alias="roll">control/roll</out>
            <out alias="pitch">control/pitch</out>
            <out alias="yaw">control/yaw</out>

            <out alias="ax">control/roll</out>
            <out alias="ay">control/pitch</out>
            <out alias="az">control/yaw</out>
            <out alias="arm">control/arm</out>
        </connect>
    </task>

    <task type="flow" name="telemetric" config="mvp_flow_telemetric.xml" priority="2" clk_method="timer" clk_period="100">
        <connect>
            <in alias="wx">control/wx</in>
            <in alias="wy">control/wy</in>
            <in alias="wz">control/wz</in>
            <in alias="ax">control/ax</in>
            <in alias="ay">control/ay</in>
            <in alias="az">control/az</in>

            <in alias="roll">control/roll</in>
            <in alias="pitch">control/pitch</in>
            <in alias="yaw">control/yaw</in>

            <in alias="manc_arm">control/arm</in>


            <out alias="roll">gcu/nav/roll</out>
            <out alias="pitch">gcu/nav/pitch</out>
            <out alias="yaw">gcu/nav/yaw</out>

            <out alias="manc_lat">gcu/cont/manc_lat</out>
            <out alias="manc_lon">gcu/cont/manc_lon</out>
            <out alias="manc_thr">gcu/cont/manc_thr</out>
            <out alias="manc_rud">gcu/cont/manc_rud</out>
            <out alias="manc_arm">gcu/cont/manc_arm</out>

            <out alias="ax">gcu/nav/ax</out>
            <out alias="ay">gcu/nav/ay</out>
            <out alias="az">gcu/nav/az</out>
            <out alias="wx">gcu/nav/wx</out>
            <out alias="wy">gcu/nav/wy</out>
            <out alias="wz">gcu/nav/wz</out>
            <out alias="sine">gcu/hk/sine</out>
        </connect>
    </task>


</swsys>
